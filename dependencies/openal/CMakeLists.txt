SET(NAME openal-soft)
SET(VERSION 1.17.2)
SET(PACKAGE ${NAME}-${VERSION})

IF (CMAKE_SYSTEM_NAME MATCHES "Darwin")
    # make sure the coreaudio framework outside of our sysroot is found
    SET (EXTRA_OPTS -DALSOFT_REQUIRE_COREAUDIO=ON -DCOREAUDIO_FRAMEWORK=/System/Library/Frameworks/CoreAudio.framework)
ENDIF ()

EXTERNALPROJECT_ADD(${NAME}
    URL https://github.com/kcat/openal-soft/archive/${PACKAGE}.tar.gz TIMEOUT 30
    INSTALL_DIR ${CMAKE_BINARY_DIR}/local
    PATCH_COMMAND patch -p0 < ${CMAKE_CURRENT_SOURCE_DIR}/disableoss.patch
    CMAKE_ARGS ${EXTRA_OPTS}
        -G ${CMAKE_GENERATOR}
        -DALSOFT_DLOPEN=OFF
        -DEXAMPLES=OFF
        -DALSOFT_MIDI_FLUIDSYNTH=OFF
        -DALSOFT_BACKEND_JACK=OFF
        -DALSOFT_BACKEND_PULSEAUDIO=OFF
        -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE}
        -DLIBTYPE=STATIC
        -DCMAKE_INSTALL_PREFIX=<INSTALL_DIR>
        -DCMAKE_TOOLCHAIN_FILE=${CMAKE_TOOLCHAIN_FILE}
)
